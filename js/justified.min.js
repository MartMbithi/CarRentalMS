function justifiedGrid(i){function e(i){return i.width()>=i.height()?"l":"p"}function n(i){i.each(function(i){$(this).css("padding",o+"px"),$(this).attr("data-index",i),$(this).addClass("hgrid-item loaded"),$(this).removeClass("resized")}),i.each(function(){$(this).css("width",$(this).find("img").width()),$(this).css("height",$(this).find("img").height()),$(this).addClass("resized")}),orientations=new Array,i.each(function(){orientations.push(e($(this)))})}function t(){$(window).width()>=960&&(max_line_score=8),$(window).width()>=660&&$(window).width()<=960&&(max_line_score=6),$(window).width()<=660&&(max_line_score=4);var i=0,e=orientations.length;lines=new Array;var n=new Array;line_score=new Array,orientations.forEach(function(t,s){"l"==t?i+2<=max_line_score?s!=e-1?(i+=2,n.push($(".hgrid-item[data-index="+s+"]"))):(i+=2,line_score.push(i),n.push($(".hgrid-item[data-index="+s+"]")),lines.push(n)):s!=e-1?(line_score.push(i),i=2,lines.push(n),n=new Array,n.push($(".hgrid-item[data-index="+s+"]"))):(line_score.push(i),i=2,line_score.push(i),lines.push(n),n=new Array,n.push($(".hgrid-item[data-index="+s+"]")),lines.push(n)):i+1<=max_line_score?s!=e-1?(i+=1,n.push($(".hgrid-item[data-index="+s+"]"))):(i+=1,line_score.push(i),n.push($(".hgrid-item[data-index="+s+"]")),lines.push(n)):s!=e-1?(line_score.push(i),i=1,lines.push(n),n=new Array,n.push($(".hgrid-item[data-index="+s+"]"))):(line_score.push(i),i=1,line_score.push(i),lines.push(n),n=new Array,n.push($(".hgrid-item[data-index="+s+"]")),lines.push(n))})}function s(){lines.forEach(function(i,e){if(line_score[e]>=max_line_score-1){i.length;$theContainer=h;var n=$theContainer.width()-2,t=0,s=[],r=[],a=[],o=0;i.forEach(function(i,e){var n=i.width(),t=i.height();s.push(n),r.push(t),a.push(n/t),o+=1});var d=[],u=0;for(f=0;o-1>=f;f++){for(j=0;j<=o-1;j++)u+=a[j]/a[f];var c=(n-(o-1)*t)/u;d.push(c),u=0}var l=d[0]/a[0],f=0;i.forEach(function(i,e){i.css({height:l,width:d[f]}),i.animate({opacity:1},500),f+=1})}else{i.length;if($theContainer=h,line_score[e]<=max_line_score/2)var n=$theContainer.width()/2-2;else var n=$theContainer.width()-$theContainer.width()/3-2;var t=0,s=[],r=[],a=[],o=0;i.forEach(function(i,e){var n=i.width(),t=i.height();s.push(n),r.push(t),a.push(n/t),o+=1});var d=[],u=0;for(f=0;o-1>=f;f++){for(j=0;j<=o-1;j++)u+=a[j]/a[f];var c=(n-(o-1)*t)/u;d.push(c),u=0}var l=d[0]/a[0],f=0;i.forEach(function(i,e){i.css({height:l,width:d[f]}),i.animate({opacity:1},500),f+=1})}})}var h=$(i.gridContainer),r=$(i.gridItems),a=i.enableImagesLoaded,o=i.gutter;this.reInitGrid=function(){r.each(function(){$(this).attr("style","")}),n(r),t(),s()},this.initGrid=function(){var i=this;if(a)h.imagesLoaded(function(){n(r),t(),s()});else{var e=$("#div").find("img, iframe"),o=e.length,d=0;e.on("load",function(){d++,d==o&&(n(r),t(),s())}),i.reInitGrid()}$(window).on("resize",function(){i.reInitGrid()})}}